---
layout: default
---
<!-- Music Player -->
<div class="music-player">
    <audio id="backgroundMusic" loop autoplay>
        <source src="/CrocPRMsite/assets/music/ost.mp3" type="audio/mpeg">
        Seu navegador n√£o suporta o elemento de √°udio.
    </audio>
    <div class="music-controls">
        <button id="playPauseBtn" class="music-btn">üéµ</button>
        <div class="music-info">
            <span id="musicTitle">ost.mp3</span>
        </div>
        <div class="volume-control">
            <input type="range" id="volumeSlider" min="0" max="100" value="10">
            <span id="volumeDisplay">10%</span>
        </div>
    </div>
    </div>

<div class="back-button-container">
    <a href="/CrocPRMsite/" class="back-button">
        ‚Üê Voltar para o in√≠cio
    </a>
</div>

<article class="post-content">
    <header class="post-header">
        <h1>{{ page.title }}</h1>
        <div class="post-meta">
            <span class="post-date">üìÖ {{ page.date | date: "%d de %B, %Y" }}</span>
            <span class="post-version">üè∑Ô∏è {{ page.title | split: "‚Äî" | last | strip }}</span>
        </div>
    </header>
    
    <div class="post-body">
        {{ content }}
    </div>
</article>

<script>
// Music Player Controls (no cross-page sync, dynamic playlist)
document.addEventListener('DOMContentLoaded', function() {
    const audio = document.getElementById('backgroundMusic');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const volumeSlider = document.getElementById('volumeSlider');
    const volumeDisplay = document.getElementById('volumeDisplay');
    const musicTitle = document.getElementById('musicTitle');

    // Build playlist from Jekyll static files under assets/music
    let playlist = [
        {% assign tracks = site.static_files | where_exp: "f", "f.path contains '/assets/music/'" %}
        {% for f in tracks %}
            {% if f.extname == '.mp3' or f.extname == '.ogg' or f.extname == '.wav' %}
            { title: '{{ f.name }}', src: '{{ f.path | prepend: site.baseurl }}' }{% if forloop.last == false %},{% endif %}
            {% endif %}
        {% endfor %}
    ].filter(Boolean);
    // Fallback: if Liquid didn't populate, build from current <source>
    if (!playlist.length) {
        const currentSourceEl = audio.querySelector('source');
        if (currentSourceEl && currentSourceEl.getAttribute('src')) {
            const url = currentSourceEl.getAttribute('src');
            const fileName = url.split('/').pop() || 'music';
            playlist = [{ title: fileName, src: url }];
        }
    }

    audio.loop = false;
    let currentTrackIndex = 0;

    function clampIndex(index) {
        if (playlist.length === 0) return 0;
        return ((index % playlist.length) + playlist.length) % playlist.length;
    }

    function loadTrack(index) {
        if (playlist.length === 0) return;
        currentTrackIndex = clampIndex(index);
        const track = playlist[currentTrackIndex];
        const sourceEl = audio.querySelector('source');
        if (sourceEl) sourceEl.setAttribute('src', track.src);
        audio.src = track.src;
        audio.load();
        if (musicTitle) musicTitle.textContent = track.title;
    }

    function nextTrack() {
        if (playlist.length === 0) return;
        const nextIndex = clampIndex(currentTrackIndex + 1);
        loadTrack(nextIndex);
        if (!audio.paused) {
            audio.play().catch(() => {});
        }
    }

    // Initial volume
    const initialVolume = 0.1;
    audio.volume = initialVolume;
    volumeSlider.value = Math.round(initialVolume * 100);
    volumeDisplay.textContent = Math.round(initialVolume * 100) + '%';

    // Initialize first track
    loadTrack(0);

    // Force update display
    setTimeout(() => {
        volumeSlider.value = Math.round(initialVolume * 100);
        volumeDisplay.textContent = Math.round(initialVolume * 100) + '%';
    }, 100);

    // Require user interaction before autoplay
    let hasUserInteracted = false;
    function enableAudio() {
        if (!hasUserInteracted) {
            hasUserInteracted = true;
        }
    }
    document.addEventListener('click', enableAudio, { once: true });
    document.addEventListener('keydown', enableAudio, { once: true });

    // Play/Pause button
    playPauseBtn.addEventListener('click', function() {
        if (audio.paused) {
            audio.play();
            playPauseBtn.textContent = '‚è∏Ô∏è';
        } else {
            audio.pause();
            playPauseBtn.textContent = 'üéµ';
        }
    });

    // Volume control
    volumeSlider.addEventListener('input', function() {
        const volume = this.value / 100;
        audio.volume = volume;
        volumeDisplay.textContent = this.value + '%';
    });

    // Update button state based on audio state
    audio.addEventListener('play', function() {
        playPauseBtn.textContent = '‚è∏Ô∏è';
    });
    audio.addEventListener('pause', function() {
        playPauseBtn.textContent = 'üéµ';
    });

    // Advance to next track when current ends
    audio.addEventListener('ended', function() {
        nextTrack();
    });
});
</script>
